<!DOCTYPE html>
<html dir="ltr" class="client-js" lang="en">
<head>
    <meta http-equiv="content-type" content="text/html; charset=UTF-8">
    <meta charset="UTF-8">
    <title>Hysys</title>
    <meta http-equiv="X-UA-Compatible" content="IE=EDGE">
	<link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
	<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
	<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
	<link rel="manifest" href="/manifest.json">
	<link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">
	<meta name="theme-color" content="#ffffff">
    <link rel="copyright" href="http://creativecommons.org/licenses/by/3.0/">
    <link rel="stylesheet" href="./_resources/wikdorlf.css">
	<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.js"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/tocbot/3.0.2/tocbot.min.js"></script>
	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/tocbot/3.0.2/tocbot.css" />
	<script src="https://cdnjs.cloudflare.com/ajax/libs/lunr.js/2.1.1/lunr.min.js"></script>
	<script src="http://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.5.0/highlight.min.js"></script>
	<script src="http://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.5.0/languages/dos.min.js"></script>
	<link rel="stylesheet" href="http://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.5.0/styles/github.min.css">

	<script>hljs.initHighlightingOnLoad();</script>
</head>
<body class="mediawiki ltr sitedir-ltr ns-0 skin-vector action-view vector-animateLayout">
    <div id="mw-page-base" class="noprint"><span></span></div>
    <div id="mw-head-base" class="noprint"><span></span></div>
    <div id="content" class="mw-body" role="main">
        <a id="top"></a>
        <div id="mw-js-message" style="display:none;"></div>
        <h1 id="firstHeading" class="firstHeading" lang="en"><span dir="auto">
		Hysys
		</span></h1>
        <div id="bodyContent">
            <div id="mw-content-text" dir="ltr" class="mw-content-ltr" lang="en">
				<!--  -->
                          <div class="js-toc"><span></span></div>
                          <div class="js-toc-content">
                          <!-- using content splitup instead of the whole page.content to add id to headers for the TOC to work -->
                          <!-- these IDs are for TOC and they are lame but they work. ideally zim would provide a random function -->
								<!-- <h1 id="6412">Hysys</h1> -->
								
								
                            	<p>
Created Saturday 18 August 2018
</p>


								<!--  -->
								<h2 id="8124">Installation</h2>
								
                            	<p>
Current release : v12 by 15/12/2020
</p>

<br>


								<!--  -->
								<h2 id="543242">Features</h2>
								
                            	<p>
<ul>
<li>Calculates Liquid-vapour equilibrium automatically.</li>
<li>The PFD is automatically generated.</li>
<li>Results are easily organized in excel.</li>
<li>When applying economic and energy analyses, it crashes down.</li>
<li>Hysys <tt>substances database</tt> don't include refrigerants or dioxanes.</li>
<li>When using substances from Aspen properties database can be incompatibility with some operations.</li>
<li>The use of substances from aspen properties slows the calculations down.</li>
</ul>
</p>


								<!--  -->
								<h2 id="866280">Economic analysis</h2>
								
                            	<p>
<ul>
<li>Evaluates the capital and operation expenses of a process. </li>
<li>identifies key cost units. </li>
<li>makes cases comparison. </li>
<li>Aspen Process Economic Analyser (APEA) enables the link the aspen capital cost estimator for more detailed cost estimates. </li>
<li>the process require the flowsheet (converged) </li>
<li>first you must enable the economics analysis on the ribbon </li>
<li>then you must to map the flowsheet (it means to list and define the type for the equipment, piping and others) </li>
<li>then you must size the equipment (this uses volumetric methods - internal for the program) </li>
<li>then you can refine the cost estimation specifying materials, utilities cost and so on. </li>
<li>you must specify the price of the feed (s) and for the product(s) of the process.  </li>
</ul>
</p>


								<!--  -->
								<h2 id="685271">Energy analysis</h2>
								
                            	<p>
<ul>
<li>It is focused in the use of internal heat exchangers to recover energy </li>
<li>Assigns cost to the utilities used for process heating/cooling depending on available types. </li>
<li>Minimizes the cost of energy (target).  </li>
<li>Identifies energy usage and energy saving potentials as well as GHG reduction potential. </li>
<li>Generates alternatives designs mainly based on the use of heat exchangers. </li>
<li>you must to incorporate heaters and coolers where necessary, expose internal streams to include them in heat integration. </li>
<li>you must include a sub-flowsheet to permit hysys doing the HEX network. </li>
</ul>
</p>


								<!--  -->
								<h2 id="12229">Exergy calculation code</h2>
								
                            	<p>
It follows the procedure proposed by <i>2011_Abdollahi-Demneh et al</i>
</p>


								<!--  -->
								
								<h3 id="933392">create user variables</h3>
                            	<p>
Set the ambient temperature and pressure (dead state) creating a new Hysys <i>User Variables</i>
</p>

<div class="zim-object">
<pre><code class="vbnet">Sub VariableChanged()
	On Error GoTo errorhandler
	Dim MS As Streams
	Dim ST As ProcessStream
	Dim X As InternalVariableWrapper
	Dim T0 As Double
	T0=activevariablewrapper.Variable.GetValue()
	Set MS=activeobject.Flowsheet.MaterialStreams
	For Each ST In MS
		Set X=ST.GetUserVariable("AmbTemp")
		X.Variable.SetValue(T0)
	Next ST
	ErrorHandler:
End Sub

Sub VariableChanged()
	On Error GoTo errorhandler
	Dim MS As Streams
	Dim ST As ProcessStream
	Dim X As InternalVariableWrapper
	Dim P0 As Double
	P0=activevariablewrapper.Variable.GetValue()
	Set MS=activeobject.Flowsheet.MaterialStreams
	For Each ST In MS
		Set X=ST.GetUserVariable("AmbPress")
		X.Variable.SetValue(P0)
	Next ST
	ErrorHandler:
End Sub
</code></pre>
</div>

<br>


								<!--  -->
								
								<h3 id="19683153">physical exergy (monophasic)</h3>
                            	<p>
<div style='padding-left: 30pt'>
<img src="./Hysys/equation.png">:
</div>
</p>
<div class="zim-object">
<pre><code class="vbnet">Sub PostExecute()
	On Error GoTo ErrorHandler
	Dim Stream As Fluid
	Dim Exergy As RealVariable
	Set Stream = ActiveObject.DuplicateFluid
	Set Pure = ActiveObject.DuplicateFluid
	Set Exergy = ActiveVariableWrapper.Variable
	Set X=activeobject.GetUserVariable("AmbTemp")
	T0=X.Variable.GetValue()
	Set X=activeobject.GetUserVariable("AmbPress")
	P0=X.Variable.GetValue()
	Set T=activeobject.Temperature
	Set P=activeobject.Pressure
	
	If (Stream.VapourFraction.IsKnown And Stream.Pressure.IsKnown And Stream.MolarFlow.IsKnown And T0&lt;&gt;(-32767+273.15) And Stream.MolarFractions.IsKnown(0)) Then
		Dim compounds As HYSYS.Components
		Dim comp As HYSYS.Component
		Dim MassFrac As Variant
		Dim MassPure As Variant
		Dim compH,compH0, comE As Double
		Dim compS,compS0,compE As Double
		MassFrac =Stream.MassFractionsValue
		MassPure=Pure.MassFractionsValue
		Set compounds = Stream.Components
		Set Pures = Pure.Components
		comE=0
			For var = 0 To compounds.Count-1
			For i = 0 To Pures.Count-1
				MassPure(i)=0
			Next i
			MassPure(var)=1
			Pure.MassFractionsValue=MassPure
					If Pure.TPFlash(Pure.TemperatureValue,Pure.PressureValue)=fsFlashOK Then
					compH=Pure.MassEnthalpy.GetValue("kJ/kg")
					compS=Pure.MassEntropy.GetValue("kJ/kg-C")
					Pure.Temperature.SetValue(T0,"C")
					Pure.Pressure.SetValue(P0,"kPa")
					Pure.TPFlash()
					compH0=Pure.MassEnthalpy.GetValue("kJ/kg")
					compS0=Pure.MassEntropy.GetValue("kJ/kg-C")
					compE=(compH-compH0)-(T0+273.15)*(compS-compS0)
					comE=comE+MassFrac(var)*compE
					Pure.Temperature.SetValue(T,"C")
					Pure.Pressure.SetValue(P,"kPa")
					End If
			Next var
			Exergy.SetValue(comE*Stream.MassFlow.GetValue("kg/s"),"kJ/s")
		Else
			Exergy.Erase()
			ErrorHandler:
		End If
		End Sub
</code></pre>
</div>

<br>


								<!--  -->
								
								<h3 id="12963103">physical exergy (whole)</h3>
                            	<p>
 mixing exergy is counted into chemical exergy addend<br>
<div style='padding-left: 60pt'>
<img src="./Hysys/equation001.png">
</div>
</p>
<div class="zim-object">
<pre><code class="vbnet">'Physical exergy calculation
		Sub PostExecute()
			On Error GoTo ErrorHandler
			Dim Stream As Fluid
			Dim Exergy As RealVariable
			Set Stream = ActiveObject.DuplicateFluid
			Set Exergy = ActiveVariableWrapper.Variable
			Dim T0,P0,H,S,H0,S0 As Double
			Set X=activeobject.GetUserVariable("AmbTemp")
			T0=X.Variable.GetValue()
			Set X=activeobject.GetUserVariable("AmbPress")
			P0=X.Variable.GetValue()
			If (Stream.VapourFraction.IsKnown And Stream.Pressure.IsKnown And Stream.MolarFlow.IsKnown And T0&lt;&gt;(-32767+273.15) And Stream.MolarFractions.IsKnown(0)) Then
				H= Stream.MassEnthalpy.GetValue("kJ/kg")
				S= Stream.MassEntropy.GetValue("kJ/kg-C")
				Stream.Temperature.SetValue(T0,"C")
				Stream.Pressure.SetValue(P0,"kPa")
				Stream.TPFlash()
				H0=Stream.MassEnthalpy.GetValue("kJ/kg")
				S0=Stream.MassEntropy.GetValue("kJ/kg-C")
				SpecEx=(H-H0)-(T0+273.15)*(S-S0)
				Exergy.SetValue(SpecEx*Stream.MassFlow.GetValue("kg/s"),"kJ/s")
			Else
				Exergy.Erase()
			End If
			ErrorHandler:
		End Sub 
</code></pre>
</div>

<br>


								<!--  -->
								
								<h3 id="71363418">physical exergy  (each phase separately)</h3>
                            	<p>
(see 1996_Hinderink et al)<br>
<div style='padding-left: 30pt'>
<img src="./Hysys/equation002.png">
</div>
</p>
<div class="zim-object">
<pre><code class="vbnet">'Physical exergy calculation
				Sub PostExecute()
					On Error GoTo ErrorHandler
					Dim Stream As Fluid
					Dim Pure As Fluid
					Dim Exergy As RealVariable
					Dim P0,T0,T,P
					Set Stream = ActiveObject.DuplicateFluid
					Set Pure = ActiveObject.DuplicateFluid
					Set Exergy = ActiveVariableWrapper.Variable
					Set X=activeobject.GetUserVariable("AmbTemp")
					T0= X.Variable.GetValue()
					Set X=activeobject.GetUserVariable("AmbPress")
					P0=X.Variable.GetValue()
					Set T=activeobject.Temperature
					Set P=activeobject.Pressure
		
					If (Stream.VapourFraction.IsKnown And Stream.Pressure.IsKnown And Stream.MassFlow.IsKnown And T0&lt;&gt;(-32767+273.15) And Stream.MassFractions.IsKnown(0)) Then
						Dim StPhases,StPhases0,PuPhases,PuPhases0 As FluidPhases
						Dim StPhase,PuPhase As FluidPhase
						Dim VMassList,LLMassList,HVMassList As Variant     'mass fractions list
						Dim PuMassList As Variant                          'mass fractions (variable)
						Dim V,LL,HL As Double
						Dim mV,mLL,mHL As Double
						Dim compH, compS As Double
						Dim sHV,sSV,sHLL,sSLL,sHHL,sSHL As Double
						Dim sHV0,sSV0,sHLL0,sSLL0,sHHL0,sSHL0 As Double
						Dim sBV,sBLL,sBHL,sBV0,sBLL0,sBHL0,sB,sB0 As Double
						Dim B As Double
						Set StPhases = Stream.FluidPhases
						PuMassList=Pure.MassFractionsValue
						V=0
						LL=0
						HL=0
						sHV=0
						sHLL=0
						sHHL=0
						sSV=0
						sSLL=0
						sSHL=0
						sHV0=0
						sHLL0=0
						sHHL0=0
						sSV0=0
						sSLL0=0
						sSHL0=0
						sB=0
						sB0=0
						mV=0
						mLL=0
						mHL=0
						For Each StPhase In StPhases
							For var = 0 To Stream.Components.Count-1
								For i = 0 To Pure.Components.Count-1
									PuMassList(i)=0
								Next i
								PuMassList(var)=1
								Pure.MassFractionsValue=PuMassList
								Pure.Temperature.SetValue(T,"C")
								Pure.Pressure.SetValue(P,"kPa")
								Pure.TPFlash()
								If Pure.TPFlash(Pure.Temperature,Pure.Pressure)=fsFlashOK Then
									Set PuPhases = Pure.FluidPhases
									If StPhase.PhaseType=ptVapourPhase Then
										Set VMassList=Stream.VapourPhase.MassFractionsValue
										V=Stream.VapourPhase.MassFeedFractionValue
										mV=Stream.VapourPhase.MassFlow.GetValue("kg/s")
										For Each PuPhase In PuPhases
											If PuPhase.PhaseType=ptVapourPhase Then
												compH=Pure.VapourPhase.MassEnthalpy.GetValue("kJ/kg")
												compS=Pure.VapourPhase.MassEntropy.GetValue("kJ/kg-C")
											ElseIf Stream.VapourPhase.MassFractionsValue(var) &gt; 0 Then
												Pure.Pressure.Erase
												Pure.VapourFraction.SetValue(1)
												Pure.TVFlash()
												compH=Pure.VapourPhase.MassEnthalpy.GetValue("kJ/kg")
												compS=Pure.VapourPhase.MassEntropy.GetValue("kJ/kg-C")
											Else
												compH=0
												compS=0
											End If
										Next PuPhase
											sHV=sHV+VMassList(var)*compH
											sSV=sSV+VMassList(var)*compS
											sBV=V*(sHV-(T0+273.15)*sSV)
									ElseIf StPhase.PhaseType=ptLiquidPhase Then
										Set LLMassList=Stream.LightLiquidPhase.MassFractionsValue
										LL=Stream.LightLiquidPhase.MassFeedFraction
										mLL=Stream.LightLiquidPhase.MassFlow.GetValue("kg/s")
										For Each PuPhase In PuPhases
											If PuPhase.PhaseType=ptLiquidPhase Then
												compH=Pure.LightLiquidPhase.MassEnthalpy.GetValue("kJ/kg")
												compS=Pure.LightLiquidPhase.MassEntropy.GetValue("kJ/kg-C")
											Else
												compH=0
												compS=0
											End If
										Next PuPhase
										sHLL=sHLL+LLMassList(var)*compH
										sSLL=sSLL+LLMassList(var)*compS
										sBLL=LL*(sHLL-(T0+273.15)*sSLL)
									ElseIf StPhase.PhaseType=ptLiquid2Phase Then
										Set HLMassList=Stream.HeavyLiquidPhase.MassFractionsValue
										HL=Stream.HeavyLiquidPhase.MassFeedFraction
										mHL=Stream.HeavyLiquidPhase.MassFlow.GetValue("kg/s")
										For Each PuPhase In PuPhases
											If PuPhase.PhaseType=ptLiquid2Phase Then
												compH=Pure.HeavyLiquidPhase.MassEnthalpy.GetValue("kJ/kg")
												compS=Pure.HeavyLiquidPhase.MassEntropy.GetValue("kJ/kg-C")
											Else
												compH=0
												compS=0
											End If
										Next PuPhase
										sHHL=sHHL+HLMassList(var)*compH
										sSHL=sSHL+HLMassList(var)*compS
										sBHL=HL*(sHHL-(T0+273.15)*sSHL)
									End If
								 End If
							Next var
						Next StPhase
						Stream.Pressure.SetValue(P0,"kPa")
						Stream.Temperature.SetValue(T0,"C")
						Stream.TPFlash()
						Set StPhases0=Stream.FluidPhases
						For Each StPhase In StPhases0
							For var = 0 To Stream.Components.Count-1
								For i = 0 To Pure.Components.Count-1
									PuMassList(i)=0
								Next i
								PuMassList(var)=1
								Pure.MassFractionsValue=PuMassList
								Pure.Temperature.SetValue(T0,"C")
								Pure.Pressure.SetValue(P0,"kPa")
								Pure.TPFlash()
								If Pure.TPFlash(T0,P0)=fsFlashOK Then
									Set PuPhases0 = Pure.FluidPhases
									If StPhase.PhaseType=ptVapourPhase Then
										Set VMassList0=Stream.VapourPhase.MassFractionsValue
										V0=Stream.VapourPhase.MassFeedFractionValue
										For Each PuPhase In PuPhases0
											If PuPhase.PhaseType=ptVapourPhase Then
												compH=Pure.VapourPhase.MassEnthalpy.GetValue("kJ/kg")
												compS=Pure.VapourPhase.MassEntropy.GetValue("kJ/kg-C")
											ElseIf Stream.VapourPhase.MassFractionsValue(var) &gt; 0 Then
												Pure.Pressure.Erase
												Pure.VapourFraction.SetValue(1)
												Pure.TVFlash()
												compH=Pure.VapourPhase.MassEnthalpy.GetValue("kJ/kg")
												compS=Pure.VapourPhase.MassEntropy.GetValue("kJ/kg-C")
											Else
												compH=0
												compS=0
											End If
										Next PuPhase
											sHV0=sHV0+VMassList0(var)*compH
											sSV0=sSV0+VMassList0(var)*compS
											sBV0=V0*(sHV0-(T0+273.15)*sSV0)
									ElseIf StPhase.PhaseType=ptLiquid2Phase Then
										Set HLMassList0=Stream.HeavyLiquidPhase.MassFractionsValue
										HL0=Stream.HeavyLiquidPhase.MassFeedFraction
										For Each PuPhase In PuPhases0
											If PuPhase.PhaseType=ptLiquid2Phase Then
												compH=Pure.HeavyLiquidPhase.MassEnthalpy.GetValue("kJ/kg")
												compS=Pure.HeavyLiquidPhase.MassEntropy.GetValue("kJ/kg-C")
											Else
												compH=0
												compS=0
											End If
										Next PuPhase
											sHHL0=sHHL0+HLMassList0(var)*compH
											sSHL0=sSHL0+HLMassList0(var)*compS
											sBHL0=HL0*(sHHL0-(T0+273.15)*sSHL0)
									End If
								End If
							Next var
						Next StPhase
						m=mV+mLL+mHL
						sB=sBV+sBLL+sBHL
						sB0=sBV0+sBLL0+sBHL0
						B=m*(sB-sB0)
						Exergy.SetValue(B,"kJ/s")
					Else
						Exergy.Erase()
					End If
					ErrorHandler:
				End Sub
</code></pre>
</div>

<br>


								<!--  -->
								
								<h3 id="17133124">mixing exergy (monophasic)</h3>
                            	<p>
<div style='padding-left: 90pt'>
<img src="./Hysys/equation003.png">
</div>
</p>
<div class="zim-object">
<pre><code class="vbnet">	Sub PostExecute()
	On Error GoTo ErrorHandler
	Dim Stream As Fluid
	Dim Exergy As RealVariable
	Set Stream = ActiveObject.DuplicateFluid
	Set Pure = ActiveObject.DuplicateFluid
	Set Exergy = ActiveVariableWrapper.Variable
	Set X=activeobject.GetUserVariable("AmbTemp")
	T0=X.Variable.GetValue()
	
	If (Stream.VapourFraction.IsKnown And Stream.Pressure.IsKnown And Stream.MolarFlow.IsKnown And T0&lt;&gt;(-32767+273.15) And Stream.MolarFractions.IsKnown(0)) Then
		Dim Comps As HYSYS.Components
		Dim Comp As HYSYS.Component
		Dim MassFrac As Variant
		Dim MassPure As Variant
		Dim ComH As Double
		Dim ComS As Double
		MassFrac =Stream.MassFractionsValue
		MassPure=Pure.MassFractionsValue
		Set Comps = Stream.Components
		Set Pures = Pure.Components
		ComH=0
		ComS=0
	
		For var = 0 To Comps.Count-1
			For i = 0 To Pures.Count-1
				MassPure(i)=0
			Next i
			MassPure(var)=1
			Pure.MassFractionsValue=MassPure
				If Pure.TPFlash(Pure.TemperatureValue,Pure.PressureValue)=fsFlashOK Then
				ComH=ComH+MassFrac(var)*Pure.MassEnthalpy.GetValue("kJ/kg")*Stream.MassFlow.GetValue("kg/s")
				ComS=ComS+MassFrac(var)*Pure.MassEntropy.GetValue("kJ/kg-C")*Stream.MassFlow.GetValue("kg/s")
				End If
		Next var
		DeltaH=Stream.MassFlow.GetValue("kg/s")*Stream.MassEnthalpy.GetValue("kJ/kg")-ComH
		DeltaS=Stream.MassFlow.GetValue("kg/s")*Stream.MassEntropy.GetValue("kJ/kg-C")-ComS
		DeltaE=DeltaH-(T0+273.15)*DeltaS
		Exergy.SetValue(DeltaE,"kJ/s")
	Else
		Exergy.Erase()
		ErrorHandler:
	End If
	End Sub
</code></pre>
</div>

<br>


								<!--  -->
								
								<h3 id="47413277">mixing exergy (multiphasic)</h3>
                            	<p>
<div style='padding-left: 60pt'>
<img src="./Hysys/equation004.png">
</div>
</p>
<div class="zim-object">
<pre><code class="vbnet">'Mixing exergy calculation
	Sub PostExecute()
		On Error GoTo ErrorHandler
		Dim Stream As Fluid
		Dim Pure As Fluid
		Dim Exergy As RealVariable
		Dim P0,T0,T,P
		Set Stream = ActiveObject.DuplicateFluid
		Set Pure = ActiveObject.DuplicateFluid
		Set Exergy = ActiveVariableWrapper.Variable
		Set X=activeobject.GetUserVariable("AmbTemp")
		T0= X.Variable.GetValue()
		Set X=activeobject.GetUserVariable("AmbPress")
		P0=X.Variable.GetValue()
		Set T=activeobject.Temperature
		Set P=activeobject.Pressure
	
		If (Stream.VapourFraction.IsKnown And Stream.Pressure.IsKnown And Stream.MassFlow.IsKnown And T0&lt;&gt;(-32767+273.15) And Stream.MassFractions.IsKnown(0)) Then
			Set StPhases = Stream.FluidPhases
			Dim StPhase As FluidPhase
			Dim PuPhase As FluidPhase
			Dim VMassList,LLMassList,HVMassList As Variant     'mass fractions list
			Dim PuMassList As Variant    'mass fractions (variable)
			Dim V,LL,HL As Double
			Dim mV,mLL,mHL As Double
			Dim compH, compS As Double
			Dim sHV,sSV,sHLL,sSLL,sHHL,sSHL As Double
			Dim tHV,tSV,tHLL,tSLL,tHHL,tSHL As Double
			Dim dHV,dHLL,dHHL,dSV,dSLL,dSHL As Double
			Dim sBV,sBLL,sBHL,sBV0,sBLL0,sBHL0,sB,sB0 As Double
			Dim B As Double
			PuMassList=Pure.MassFractionsValue
			V=0
			LL=0
			HL=0
			sHV=0
			sHLL=0
			sHHL=0
			sSV=0
			sSLL=0
			sSHL=0
			sB=0
			mV=0
			mLL=0
			mHL=0
			For Each StPhase In stphases
				For var = 0 To Stream.Components.Count-1
					For i = 0 To Pure.Components.Count-1
						PuMassList(i)=0
					Next i
					PuMassList(var)=1
					Pure.MassFractionsValue=PuMassList
					Pure.TPFlash(T,P)
					If Pure.TPFlash(T,P)=fsFlashOK Then
						Set PuPhases = Pure.FluidPhases
						If StPhase.PhaseType=ptVapourPhase Then
							Set VMassList=Stream.VapourPhase.MassFractionsValue
							V=Stream.VapourPhase.MassFeedFractionValue
							mV=Stream.VapourPhase.MassFlow.GetValue("kg/s")
							For Each PuPhase In puphases
								If PuPhase.PhaseType=ptVapourPhase Then
									compH=Pure.VapourPhase.MassEnthalpy.GetValue("kJ/kg")
									compS=Pure.VapourPhase.MassEntropy.GetValue("kJ/kg-C")
								ElseIf Stream.VapourPhase.MassFractionsValue(var) &gt; 0 Then
									Pure.Pressure.Erase
									Pure.VapourFraction.SetValue(1,"")
									Pure.TVFlash()
									compH=Pure.VapourPhase.MassEnthalpy.GetValue("kJ/kg")
									compS=Pure.VapourPhase.MassEntropy.GetValue("kJ/kg-C")
								Else
									compH=0
									compS=0
								End If
							Next PuPhase
							sHV=sHV+VMassList(var)*compH
							sSV=sSV+VMassList(var)*compS
							tHV=Stream.VapourPhase.MassEnthalpy.GetValue("kJ/kg")
							tSV=Stream.VapourPhase.MassEntropy.GetValue("kJ/kg-C")
							dHV=tHV-sHV
							dSV=tSV-sSV
							sBV=V*(dHV-(T0+273.15)*dSV)
						ElseIf StPhase.PhaseType=ptLiquidPhase Then
							Set LLMassList=Stream.LightLiquidPhase.MassFractionsValue
							LL=Stream.LightLiquidPhase.MassFeedFraction
							mLL=Stream.LightLiquidPhase.MassFlow.GetValue("kg/s")
							For Each PuPhase In puphases
								If PuPhase.PhaseType=ptLiquidPhase Then
									compH=Pure.LightLiquidPhase.MassEnthalpy.GetValue("kJ/kg")
									compS=Pure.LightLiquidPhase.MassEntropy.GetValue("kJ/kg-C")
								Else
									compH=0
									compS=0
								End If
							Next
							sHLL=sHLL+LLMassList(var)*compH
							sSLL=sSLL+LLMassList(var)*compS
							tHLL=Stream.LightLiquidPhase.MassEnthalpy.GetValue("kJ/kg")
							tSLL=Stream.LightLiquidPhase.MassEntropy.GetValue("kJ/kg-C")
							dHLL=tHLL-sHLL
							dSLL=tSLL-sSLL
							sBLL=LL*(dHLL-(T0+273.15)*dSLL)
						ElseIf StPhase.PhaseType=ptLiquid2Phase Then
							Set HLMassList=Stream.HeavyLiquidPhase.MassFractionsValue
							HL=Stream.HeavyLiquidPhase.MassFeedFraction
							mHL=Stream.HeavyLiquidPhase.MassFlow.GetValue("kg/s")
							For Each PuPhase In puphases
								If PuPhase.PhaseType=ptLiquid2Phase Then
									compH=Pure.HeavyLiquidPhase.MassEnthalpy.GetValue("kJ/kg")
									compS=Pure.HeavyLiquidPhase.MassEntropy.GetValue("kJ/kg-C")
								Else
									compH=0
									compS=0
								End If
							Next
							sHHL=sHHL+HLMassList(var)*compH
							sSHL=sSHL+HLMassList(var)*compS
							tHHL=Stream.HeavyLiquidPhase.MassEnthalpy.GetValue("kJ/kg")
							tSHL=Stream.HeavyLiquidPhase.MassEntropy.GetValue("kJ/kg-C")
							dHHL=tHHL-sHHL
							dSHL=tSHL-sSHL
							sBHL=HL*(dHHL-(T0+273.15)*dSHL)
						End If
					 End If
				Next var
			Next
			B=mV*sBV+mLL*sBLL+mHL*sBHL
			Exergy.SetValue(B,"kJ/s")
		Else
			Exergy.Erase()
		End If
		ErrorHandler:
	End Sub

</code></pre>
</div>

<br>


								<!--  -->
								
								<h3 id="15163113">chemical exergy</h3>
                            	<p>
Calculate the chemical exergy, it can be done applying/adapting the code in <i>2011_Abdollahi-Demneh et al.</i> ,or calling a previously defined User Property  corresponding to the standard chemical exergy as proposed by Szargut for each component within the model.<br>
<ol type="1" start="1">
<li>the first method uses the following method</li>
<li>the second method uses the following method</li>
</ol>
</p>
<div class="zim-object">
<pre><code class="vbnet">'Chemical Exergy With Heat Flow Unit
	Sub PostExecute()
	On Error GoTo ErrorHandler
	Dim Stream As Fluid
	Dim Exergy As RealVariable
	Set Stream = ActiveObject.DuplicateFluid
	Set Exergy = ActiveVariableWrapper.Variable
	If (Stream.VapourFraction.IsKnown And Stream.Pressure.IsKnown And Stream.MolarFlow.IsKnown And T0&lt;&gt;(-32767+273.15) And Stream.MolarFractions.IsKnown(0)) Then
		Dim Comps As HYSYS.Components
		Dim Comp As HYSYS.Component
		Dim MolFrac As Variant
		Dim Comchem As Double
		MolFrac =Stream.MolarFractionsValue
		Set Comps = Stream.Components
		Comchem=0
		For var = 0 To Comps.Count-1
			Set Comp = Comps.Item(var)
			If MolFrac(var)=0 Then
				Comchem=Comchem+MolFrac(var)*Comp.GetUserProperty("Mol Chm Ex.")
			Else
				Comchem=Comchem+MolFrac(var)*Comp.GetUserProperty("Mol Chm Ex.")'+MolFrac(var)*Log(MolFrac(var))
			End If
		Next var
		Exergy.SetValue(Comchem*Stream.MolarFlow.GetValue("kgmole/s"),"kJ/s")
	Else
		Exergy.Erase()
		ErrorHandler:
	End If
	End Sub
</code></pre>
</div>

<br>


								<!--  -->
								
								<h3 id="1098374">total spec exergy</h3>
                            	<div class="zim-object">
<pre><code class="vbnet">'Chemical Exergy With Heat Flow Unit
	Sub PostExecute()
	On Error GoTo ErrorHandler
	Dim Stream As Fluid
	Dim Exergy As RealVariable
	Set Stream = ActiveObject.DuplicateFluid
	Set Exergy = ActiveVariableWrapper.Variable
	If (Stream.VapourFraction.IsKnown And Stream.Pressure.IsKnown And Stream.MolarFlow.IsKnown And T0&lt;&gt;(-32767+273.15) And Stream.MolarFractions.IsKnown(0)) Then
		Dim Comps As HYSYS.Components
		Dim Comp As HYSYS.Component
		Dim MolFrac As Variant
		Dim Comchem As Double
		MolFrac =Stream.MolarFractionsValue
		Set Comps = Stream.Components
		Comchem=0
		For var = 0 To Comps.Count-1
			Set Comp = Comps.Item(var)
			If MolFrac(var)=0 Then
				Comchem=Comchem+MolFrac(var)*Comp.GetUserProperty("Mol Chm Ex.")
			Else
				Comchem=Comchem+MolFrac(var)*Comp.GetUserProperty("Mol Chm Ex.")'+MolFrac(var)*Log(MolFrac(var))
			End If
		Next var
		Exergy.SetValue(Comchem*Stream.MolarFlow.GetValue("kgmole/s"),"kJ/s")
	Else
		Exergy.Erase()
		ErrorHandler:
	End If
	End Sub
</code></pre>
</div>


                            <br><br>
		            </div>
				<!--  -->
            </div>
            <br>
            <div class="visualClear"><span></span></div>

    <!--  -->
		<!--  -->
		<!--  -->
			<!--  -->
				<!-- <b>Attachments:</b> -->
				<!-- <table> -->
			<!--  -->
				<!-- <tr><td><a href='./Hysys/equation.png'>equation.png</a></td><td>&nbsp;</td><td>1.50kb</td></tr> -->
    		<!--  -->
		<!--  -->
			<!--  -->
				<!-- <tr><td><a href='./Hysys/equation.tex'>equation.tex</a></td><td>&nbsp;</td><td>59b</td></tr> -->
    		<!--  -->
		<!--  -->
			<!--  -->
				<!-- <tr><td><a href='./Hysys/equation001.png'>equation001.png</a></td><td>&nbsp;</td><td>1.21kb</td></tr> -->
    		<!--  -->
		<!--  -->
			<!--  -->
				<!-- <tr><td><a href='./Hysys/equation001.tex'>equation001.tex</a></td><td>&nbsp;</td><td>45b</td></tr> -->
    		<!--  -->
		<!--  -->
			<!--  -->
				<!-- <tr><td><a href='./Hysys/equation002.png'>equation002.png</a></td><td>&nbsp;</td><td>3.36kb</td></tr> -->
    		<!--  -->
		<!--  -->
			<!--  -->
				<!-- <tr><td><a href='./Hysys/equation002.tex'>equation002.tex</a></td><td>&nbsp;</td><td>187b</td></tr> -->
    		<!--  -->
		<!--  -->
			<!--  -->
				<!-- <tr><td><a href='./Hysys/equation003.png'>equation003.png</a></td><td>&nbsp;</td><td>897b</td></tr> -->
    		<!--  -->
		<!--  -->
			<!--  -->
				<!-- <tr><td><a href='./Hysys/equation003.tex'>equation003.tex</a></td><td>&nbsp;</td><td>39b</td></tr> -->
    		<!--  -->
		<!--  -->
			<!--  -->
				<!-- <tr><td><a href='./Hysys/equation004.png'>equation004.png</a></td><td>&nbsp;</td><td>1.59kb</td></tr> -->
    		<!--  -->
		<!--  -->
			<!--  -->
				<!-- <tr><td><a href='./Hysys/equation004.tex'>equation004.tex</a></td><td>&nbsp;</td><td>50b</td></tr> -->
    		<!--  -->
			<!-- </table> -->
			<!--  -->
		<!--  -->
	<!--  -->

        </div>
        <div id="disqus_thread"><span></span></div>

    </div>
    <div id="mw-navigation">
        <h2>Navigation menu</h2>
        <div id="mw-head">
            <div id="left-navigation">
                <div id="p-namespaces" role="navigation" class="vectorTabs" aria-labelledby="p-namespaces-label">
                    <h3 id="p-namespaces-label">Namespaces</h3>
                    <ul>
                        <li id="ca-nstab-main" class="selected"><span>{SITE_TITLE}</span></li>
                    </ul>
                </div>
            </div>
            <div id="right-navigation">
                <div id="p-views" role="navigation" class="vectorTabs" aria-labelledby="p-views-label">
                    <h3 id="p-views-label">Views</h3>
                    <ul>
                        <!-- <li id="ca-view" class="selected"><span>Read</span></li> -->
                        <!--  -->
                        <!-- <li id="ca-edit"><span><a href="#disqus_thread">Comment</a></span></li> -->
                        <!--  -->
                        <!--<li id="ca-history"><span>View history</span></li>-->
                        <div id="p-search" role="search">
                            <form action="https://www.google.com/search" method="GET" name="searchForm" id="searchForm" enctype="application/x-www-form-urlencoded" >

							<div id="simpleSearch">
							<input name="sitesearch" value="grimdorlf.github.io/technotes" type="hidden">
                            <input id="searchInput" name="q" results="0" placeholder="Search {SITE_TITLE}..." title="Search {SITE_TITLE}..." tabindex="1" autocomplete="off" type="search">
                            <input id="searchButton" name="go" value="Go" title="Go to a page with this exact name if it exists" class="searchButton" type="submit">
							</div>

							<div class="suggestions"><div class="suggestions-results"><span></span></div></div>
                            </form>
					    </div>

                    </ul>
                </div>
                <div id="p-cactions" role="navigation" class="vectorMenu emptyPortlet" aria-labelledby="p-cactions-label">
                    <h3 tabindex="0" id="p-cactions-label"><span>Actions</span><a tabindex="-1" href="#"></a></h3>
                    <div class="menu">
                        <ul>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
        <div class="collapsible-nav" id="mw-panel">
            <div id="p-logo" role="banner">
                <a style="background-image: url(./_resources/logo.png); background-size: contain;" href="./About.html" title="Visit the main page"><span></span></a>
            </div>
            <div class="portal first persistent" role="navigation" id="p-navigation" aria-labelledby="p-navigation-label">
                <h3 id="p-navigation-label">Navigation</h3>
                <div class="body">
                    <ul>
                        <!-- <li ><a href="./index.html">Main page</a></li> -->
                        <!-- <li ><a href="./How_To.html">How To</a></li> -->
                        <!-- <li ><a href="./Troubleshooting.html">Troubleshoting</a></li> -->
                        <!-- <li ><a href="./Technical_Notes.html">Technical Notes</a></li> -->
                        <!-- <li ><a href="./Tools_and_Scripts.html">Tools and Scripts</a></li> -->
						<ul>
<li><a href="./About.html" title="About" class="page">About</a></li>
<li><a href="./Biblio_organizers.html" title="Biblio organizers" class="page">Biblio organizers</a></li>
<li><a href="./Cloud_computing.html" title="Cloud computing" class="page">Cloud computing</a></li>
<li><a href="./Code_editors.html" title="Code editors" class="page">Code editors</a></li>
<li><a href="./Dynalist.html" title="Dynalist" class="page">Dynalist</a></li>
<li><a href="./EES.html" title="EES" class="page">EES</a></li>
<li><a href="./Energy+.html" title="Energy+" class="page">Energy+</a></li>
<li><a href="./epub_books.html" title="epub books" class="page">epub books</a></li>
<li><a href="./Excel.html" title="Excel" class="page">Excel</a></li>
<li><a href="./Git.html" title="Git" class="page">Git</a></li>
<li><a href="./Gurobi.html" title="Gurobi" class="page">Gurobi</a></li>
<li><b>Hysys</b></li>
<li><a href="./Jupyter_notebooks.html" title="Jupyter notebooks" class="page">Jupyter notebooks</a></li>
<li><a href="./LaTeX.html" title="LaTeX" class="page">LaTeX</a></li>
<li><a href="./LINGO.html" title="LINGO" class="page">LINGO</a></li>
<li><a href="./Note_Apps.html" title="Note Apps" class="page">Note Apps</a></li>
<li><a href="./Optimizers.html" title="Optimizers" class="page">Optimizers</a></li>
<li><a href="./Podcast_Apps.html" title="Podcast Apps" class="page">Podcast Apps</a></li>
<li><a href="./Pyomo.html" title="Pyomo" class="page">Pyomo</a></li>
<li><a href="./Python.html" title="Python" class="page">Python</a></li>
<li><a href="./Visual_Studio_2017.html" title="Visual Studio 2017" class="page">Visual Studio 2017</a></li>
<li><a href="./Zim_notes.html" title="Zim notes" class="page">Zim notes</a></li>
<li><a href="./Zotero.html" title="Zotero" class="page">Zotero</a></li>
</ul>

                    </ul>
                </div>
            </div>
            <div class="portal">
            	<div style="display: block;" class="body">
            		<ul id="p-tb-list">
                        <li><a href="./index.html" title="Index">Index</a></li>
                        <li><a href="./About.html" title="About">About</a></li>
                        <!-- <li><a href="./Contact_Info.html" title="Contact Info">Contact Info</a></li> -->
            		</ul>
            	</div>
            </div>
        </div>
    </div>
    <div id="footer" role="contentinfo">
        <ul id="footer-places">
            <li id="footer-places-about"><a href="./About.html" title="About">About {SITE_TITLE}</a></li>
            <!-- <li id="footer-places-disclaimer"><a href="./General_disclaimer.html" title="General disclaimer">Disclaimers</a></li> -->
            <li id="footer-info-copyright">Content is available under <a class="external" rel="nofollow" href="http://creativecommons.org/licenses/by/3.0/">Attribution 3.0 Unported</a> unless otherwise noted.</li>
        </ul>
		<ul id="footer-icons" class="noprint">
				<li id="footer-copyrightico">
					<a href="http://creativecommons.org/licenses/by/3.0/"><img src="./_resources/ccby_88x31.png" alt="Attribution 3.0 Unported" height="31" width="88"></a>
			</li>
		</ul>
    </div>
	<button onclick="topFunction()" id="myBtn" title="Go to top">top</button>
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', '{GOOGLE_ANALYTICS_ID}', 'auto');
  ga('send', 'pageview');

</script>

<script>
//Get the button:
mybutton = document.getElementById("myBtn");

// When the user scrolls down 20px from the top of the document, show the button
window.onscroll = function() {scrollFunction()};

function scrollFunction() {
  if (document.body.scrollTop > 20 || document.documentElement.scrollTop > 20) {
    mybutton.style.display = "block";
  } else {
    mybutton.style.display = "none";
  }
}

// When the user clicks on the button, scroll to the top of the document
function topFunction() {
  document.body.scrollTop = 0; // For Safari
  document.documentElement.scrollTop = 0; // For Chrome, Firefox, IE and Opera
}
</script>

<script>
$(document).ready(function () {
    'use strict';
    /* Set up search */
    $.getJSON('/searchIndex.json', function (response) {
	    var index, store;
        // Create index
        index = lunr.Index.load(response.index);
        // Create store
        store = response.store;
        // Handle search
        $('input#searchInput').on('keyup', function () {
            // Get query
            var query = $(this).val();
            // Search for it
            var resultdiv = $('div.suggestions');
            if(query === ''){
                /*resultdiv.empty();*/
                resultdiv.hide();
            }
            else {
                var result = index.search(query);
                // Output it
                if (result.length === 0) {
                    // Hide results
                    resultdiv.hide();
                } else {
                    // Show results
                    var subresultdiv=$('div.suggestions-results')
                    subresultdiv.empty();
                    for (var item in result) {
                        var ref = result[item].ref;
                        var searchitem = '<a class="mw-searchSuggest-link" href="' + ref + '"><div class="suggestions-result">' + store[ref].title + '</div></a>';
                        subresultdiv.append(searchitem);
                    }
                    resultdiv.show();
                }
            }
        });
    });
	tocbot.init({
  		tocSelector: '.js-toc',
  		contentSelector: '.js-toc-content',
  		headingSelector: 'h2',
	});
});
/* autohide search box */
$(document).mouseup(function(e) {
    var container = $("div.suggestions");
    if (!container.is(e.target) && container.has(e.target).length === 0) {
        container.hide();
    }
    var searchbox = $('div#p-search');
    if (searchbox.is(e.target) || searchbox.has(e.target).length !== 0) {
        container.show();
    }
});

/*  disqus */
var disqus_config = function () {
	this.page.url = "http:///Hysys.html-1";
	this.page.identifier = "Hysys-1";
};

(function() { var d = document, s = d.createElement('script'); s.src = 'https://{DISQUS_URL}/embed.js'; s.setAttribute('data-timestamp', +new Date()); (d.head || d.body).appendChild(s); })();

</script>
<noscript>Please enable JavaScript to get search, toc, comments and other stuff.</noscript>
</body>
</html>